#!/bin/bash

set -x -e

export DEBIAN_FRONTEND=noninteractive;

pip install --extra-index-url https://us-python.pkg.dev/colab-wheels/public/simple --extra-index-url https://download.pytorch.org/whl/cu118 pyct==0.5.0 pydantic==1.10.7 pydata-google-auth==1.7.0 pydot==1.4.2 pydot-ng==2.0.0 pydotplus==2.0.2 PyDrive==1.3.1 pyerfa==2.0.0.3 pygame==2.3.0 Pygments==2.14.0 PyGObject==3.36.0 pymc==5.1.2 PyMeeus==0.5.12 pymystem3==0.2.0 PyOpenGL==3.1.6 pyparsing==3.0.9 pyrsistent==0.19.3 PySocks==1.7.1 pytensor==2.10.1 pytest==7.2.2 python-dateutil==2.8.2 python-louvain==0.16 python-slugify==8.0.1 python-utils==3.5.2 pytz==2022.7.1 pytz-deprecation-shim==0.1.0.post0 pyviz-comms==2.2.1 PyWavelets==1.4.1 PyYAML==6.0 pyzmq==23.2.1 qdldl==0.1.7 qudida==0.0.4 regex==2022.10.31 requests==2.27.1 requests-oauthlib==1.3.1 requests-unixsocket==0.2.0 rich==13.3.3 rpy2==3.5.5 rsa==4.9 scikit-image==0.19.3 scikit-learn==1.2.2 scipy==1.10.1 scs==3.2.3 seaborn==0.12.2 Send2Trash==1.8.0 setuptools==67.6.1 shapely==2.0.1 six==1.16.0 sklearn-pandas==2.2.0 smart-open==6.3.0 sniffio==1.3.0 snowballstemmer==2.2.0 sortedcontainers==2.4.0 soundfile==0.12.1 soupsieve==2.4 soxr==0.3.5 spacy==3.5.1 spacy-legacy==3.0.12 spacy-loggers==1.0.4 Sphinx==3.5.4 sphinxcontrib-applehelp==1.0.4 sphinxcontrib-devhelp==1.0.2 sphinxcontrib-htmlhelp==2.0.1 sphinxcontrib-jsmath==1.0.1 sphinxcontrib-qthelp==1.0.3 sphinxcontrib-serializinghtml==1.1.5 SQLAlchemy==2.0.9 sqlparse==0.4.3 srsly==2.4.6 statsmodels==0.13.5 sympy==1.11.1 tables==3.8.0 tabulate==0.8.10 tblib==1.7.0 tenacity==8.2.2 tensorboard==2.12.1 tensorboard-data-server==0.7.0 tensorboard-plugin-wit==1.8.1 tensorflow==2.12.0 tensorflow-datasets==4.8.3 tensorflow-estimator==2.12.0 tensorflow-gcs-config==2.12.0 tensorflow-hub==0.13.0 tensorflow-io-gcs-filesystem==0.32.0 tensorflow-metadata==1.13.0 tensorflow-probability==0.19.0 tensorstore==0.1.35 termcolor==2.2.0 terminado==0.17.1 text-unidecode==1.3 textblob==0.17.1 tf-slim==1.1.0 thinc==8.1.9 threadpoolctl==3.1.0 tifffile==2023.3.21 tinycss2==1.2.1 toml==0.10.2 tomli==2.0.1 toolz==0.12.0 torch==2.0.0+cu118 torchaudio==2.0.1+cu118 torchdata==0.6.0 torchsummary==1.5.1 torchtext==0.15.1 torchvision==0.15.1+cu118 tornado==6.2 tqdm==4.65.0 traitlets==5.7.1 triton==2.0.0 tweepy==4.13.0 typer==0.7.0 typing_extensions==4.5.0 tzdata==2023.3 tzlocal==4.3 uritemplate==4.1.1 urllib3==1.26.15 vega-datasets==0.9.0 wasabi==1.1.1 wcwidth==0.2.6 webcolors==1.13 webencodings==0.5.1 websocket-client==1.5.1 Werkzeug==2.2.3 wheel==0.40.0 widgetsnbextension==3.6.4 wordcloud==1.8.2.2 wrapt==1.14.1 xarray==2022.12.0 xarray-einstats==0.5.1 xgboost==1.7.5 xlrd==2.0.1 yellowbrick==1.5 yfinance==0.2.17 zict==2.2.0 zipp==3.15.0

# check if libtorch_global_deps.so exists, 
# otherwizse reinstall torch for issue: can not load libtorch_global_deps.so
find / -name "libtorch_global_deps.so" || {
    pip uninstall torch==2.0.0+cu118
    pip install --extra-index-url https://us-python.pkg.dev/colab-wheels/public/simple --extra-index-url https://download.pytorch.org/whl/cu118
}
